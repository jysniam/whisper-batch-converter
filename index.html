<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Batch MP3 to SRT Converter - GitHub Pages</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .main-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .method-tabs {
            display: flex;
            background: #f5f5f5;
            border-radius: 15px;
            padding: 5px;
            margin-bottom: 30px;
        }

        .tab-btn {
            flex: 1;
            background: transparent;
            border: none;
            padding: 15px 20px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .tab-btn.active {
            background: linear-gradient(45deg, #4caf50 0%, #388e3c 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.3);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .batch-section {
            background: linear-gradient(45deg, #e8f5e8 0%, #f1f8f1 100%);
            border: 2px solid #4caf50;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .batch-section h3 {
            color: #2e7d32;
            margin-bottom: 15px;
        }

        .upload-zone {
            border: 3px dashed #4caf50;
            border-radius: 15px;
            padding: 60px 20px;
            text-align: center;
            background: linear-gradient(45deg, #f1f8e9 0%, #e8f5e8 100%);
            margin: 20px 0;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .upload-zone:hover {
            border-color: #388e3c;
            background: linear-gradient(45deg, #e8f5e8 0%, #dcedc8 100%);
            transform: translateY(-2px);
        }

        .upload-zone.dragover {
            border-color: #2e7d32;
            background: linear-gradient(45deg, #dcedc8 0%, #c8e6c8 100%);
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 4rem;
            color: #4caf50;
            margin-bottom: 20px;
        }

        .upload-text {
            font-size: 1.3rem;
            color: #2e7d32;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .upload-subtext {
            color: #388e3c;
            font-size: 0.9rem;
        }

        .file-input {
            display: none;
        }

        .btn {
            background: linear-gradient(45deg, #4caf50 0%, #388e3c 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 50px;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4);
            margin: 10px 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(76, 175, 80, 0.6);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .btn.secondary {
            background: linear-gradient(45deg, #2196f3 0%, #1976d2 100%);
            box-shadow: 0 4px 15px rgba(33, 150, 243, 0.4);
        }

        .btn.secondary:hover {
            box-shadow: 0 8px 25px rgba(33, 150, 243, 0.6);
        }

        .file-list {
            margin: 30px 0;
        }

        .file-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            background: #f1f8e9;
            border-radius: 10px;
            margin-bottom: 10px;
            border-left: 4px solid #4caf50;
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 15px;
            flex: 1;
        }

        .file-icon {
            font-size: 1.5rem;
            color: #4caf50;
        }

        .file-details h4 {
            color: #2e7d32;
            margin-bottom: 5px;
        }

        .file-details p {
            color: #388e3c;
            font-size: 0.9rem;
        }

        .file-actions {
            display: flex;
            gap: 10px;
        }

        .small-btn {
            background: linear-gradient(45deg, #2e7d32 0%, #1b5e20 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .small-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(46, 125, 50, 0.4);
        }

        .batch-progress {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #c8e6c8;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4caf50, #2e7d32);
            transition: width 0.3s ease;
            width: 0%;
        }

        .settings-panel {
            background: #f8f9ff;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #c8e6c8;
        }

        .settings-panel h4 {
            color: #2e7d32;
            margin-bottom: 15px;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .setting-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #2e7d32;
        }

        .setting-group select, .setting-group input {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid #c8e6c8;
            border-radius: 6px;
            font-size: 14px;
            background: white;
        }

        .real-transcription {
            background: linear-gradient(45deg, #fff3e0 0%, #fffbf0 100%);
            border: 2px solid #ff9800;
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
        }

        .real-transcription h3 {
            color: #f57c00;
            margin-bottom: 15px;
        }

        .step-list {
            margin: 15px 0;
        }

        .step-item {
            background: white;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #ff9800;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .step-number {
            display: inline-block;
            background: #ff9800;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            text-align: center;
            line-height: 25px;
            font-weight: bold;
            margin-right: 10px;
            font-size: 0.9rem;
        }

        .tool-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .tool-link {
            background: linear-gradient(45deg, #2196f3 0%, #1976d2 100%);
            color: white;
            text-decoration: none;
            padding: 15px 20px;
            border-radius: 10px;
            text-align: center;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .tool-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(33, 150, 243, 0.4);
        }

        .feature-list {
            margin: 15px 0;
        }

        .feature-list li {
            margin: 8px 0;
            padding-left: 25px;
            position: relative;
            line-height: 1.5;
        }

        .feature-list li:before {
            content: "‚úÖ";
            position: absolute;
            left: 0;
        }

        .download-section {
            background: linear-gradient(45deg, #e8f5e8 0%, #f1f8f1 100%);
            border-radius: 15px;
            padding: 25px;
            margin: 30px 0;
            text-align: center;
            display: none;
        }

        .download-section.show {
            display: block;
        }

        @media (max-width: 768px) {
            .main-card {
                padding: 20px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .method-tabs {
                flex-direction: column;
            }
            
            .upload-zone {
                padding: 40px 15px;
            }
            
            .file-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }

            .file-actions {
                width: 100%;
                justify-content: flex-end;
            }

            .tool-links {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ Batch MP3 to SRT Converter</h1>
            <p>Professional batch conversion with real transcription - works on GitHub Pages</p>
        </div>

        <div class="main-card">
            <div class="method-tabs">
                <button class="tab-btn active" onclick="switchTab('batch')">üìÅ Batch Templates</button>
                <button class="tab-btn" onclick="switchTab('real')">üé§ Real Transcription</button>
                <button class="tab-btn" onclick="switchTab('workflow')">üîÑ Complete Workflow</button>
            </div>

            <!-- Batch Templates Tab -->
            <div class="tab-content active" id="batchTab">
                <div class="batch-section">
                    <h3>üìÅ Batch SRT Template Generator</h3>
                    <p>Upload multiple MP3 files and generate perfectly timed SRT templates for all of them at once. Perfect for batch manual transcription workflow.</p>
                    
                    <div class="upload-zone" onclick="document.getElementById('fileInput').click()">
                        <div class="upload-icon">üìÅ</div>
                        <div class="upload-text">Drop multiple MP3 files here or click to browse</div>
                        <div class="upload-subtext">Select multiple files ‚Ä¢ Batch processing ‚Ä¢ Perfect timing templates</div>
                    </div>

                    <input type="file" id="fileInput" class="file-input" accept=".mp3,.wav,.m4a,.ogg,.flac" multiple>

                    <div class="settings-panel">
                        <h4>‚öôÔ∏è Batch Template Settings</h4>
                        <div class="settings-grid">
                            <div class="setting-group">
                                <label for="segmentLength">Segment Length:</label>
                                <select id="segmentLength">
                                    <option value="3">3 seconds (detailed)</option>
                                    <option value="5">5 seconds (standard)</option>
                                    <option value="8" selected>8 seconds (balanced)</option>
                                    <option value="10">10 seconds (longer)</option>
                                    <option value="15">15 seconds (chapters)</option>
                                </select>
                            </div>
                            <div class="setting-group">
                                <label for="templateStyle">Template Style:</label>
                                <select id="templateStyle">
                                    <option value="edit">Editable placeholders</option>
                                    <option value="numbered">Numbered segments</option>
                                    <option value="timestamp">Timestamp labels</option>
                                    <option value="speaker">Speaker labels</option>
                                    <option value="blank">Blank lines</option>
                                </select>
                            </div>
                            <div class="setting-group">
                                <label for="namingPattern">File Naming:</label>
                                <select id="namingPattern">
                                    <option value="original">Original name + .srt</option>
                                    <option value="template">name_template.srt</option>
                                    <option value="numbered">01_name.srt, 02_name.srt</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div style="text-align: center; margin: 20px 0;">
                        <button class="btn" id="generateAllBtn" onclick="generateAllTemplates()" disabled>
                            üöÄ Generate All SRT Templates
                        </button>
                        <button class="btn secondary" onclick="clearAllFiles()">
                            üóëÔ∏è Clear All Files
                        </button>
                        <button class="btn secondary" onclick="downloadTestSRT()">
                            üß™ Download Test SRT
                        </button>
                    </div>

                    <div class="batch-progress" id="batchProgress" style="display: none;">
                        <h4>Processing Batch...</h4>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill"></div>
                        </div>
                        <p id="progressText">Preparing...</p>
                    </div>

                    <div class="file-list" id="fileList"></div>

                    <div class="download-section" id="downloadSection">
                        <h3>‚úÖ Batch Templates Complete!</h3>
                        <p>All SRT templates have been generated and downloaded. Use these with real transcription tools!</p>
                    </div>
                </div>
            </div>

            <!-- Real Transcription Tab -->
            <div class="tab-content" id="realTab">
                <div class="real-transcription">
                    <h3>üé§ Real Audio Transcription Services</h3>
                    <p>Use these proven services to convert your MP3 files to actual transcribed SRT files with real speech-to-text conversion.</p>
                    
                    <div class="tool-links">
                        <a href="https://otter.ai" target="_blank" class="tool-link">
                            ü¶¶ Otter.ai<br><small>600 mins free/month</small>
                        </a>
                        <a href="https://www.happyscribe.com" target="_blank" class="tool-link">
                            üòä Happy Scribe<br><small>10 mins free trial</small>
                        </a>
                        <a href="https://www.notta.ai" target="_blank" class="tool-link">
                            üéµ Notta.ai<br><small>120 mins free/month</small>
                        </a>
                        <a href="https://studio.youtube.com" target="_blank" class="tool-link">
                            üì∫ YouTube Studio<br><small>Unlimited & free</small>
                        </a>
                        <a href="https://www.descript.com" target="_blank" class="tool-link">
                            üìù Descript<br><small>Free tier available</small>
                        </a>
                        <a href="https://www.temi.com" target="_blank" class="tool-link">
                            üéØ Temi<br><small>$0.25/minute</small>
                        </a>
                    </div>

                    <div class="step-list">
                        <div class="step-item">
                            <span class="step-number">1</span>
                            <strong>Choose a Service:</strong> Pick from the links above based on your needs (free vs paid, accuracy requirements, monthly limits)
                        </div>
                        <div class="step-item">
                            <span class="step-number">2</span>
                            <strong>Upload Your MP3s:</strong> Most services support batch upload or drag-and-drop multiple files
                        </div>
                        <div class="step-item">
                            <span class="step-number">3</span>
                            <strong>Wait for Processing:</strong> AI transcription typically takes 25-50% of your audio length
                        </div>
                        <div class="step-item">
                            <span class="step-number">4</span>
                            <strong>Download SRT Files:</strong> Export as SRT format with timestamps and real transcribed text
                        </div>
                    </div>

                    <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin: 15px 0;">
                        <h4 style="color: #2e7d32; margin-bottom: 10px;">üí° Recommended Workflow:</h4>
                        <ul class="feature-list">
                            <li><strong>YouTube Method:</strong> Upload as unlisted videos, get auto-captions, download SRT</li>
                            <li><strong>Otter.ai:</strong> Best for regular use with 600 free minutes monthly</li>
                            <li><strong>Batch Processing:</strong> Most services allow multiple file uploads</li>
                            <li><strong>Quality Check:</strong> Use templates from this tool to verify timing accuracy</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Complete Workflow Tab -->
            <div class="tab-content" id="workflowTab">
                <div class="real-transcription">
                    <h3>üîÑ Complete Batch Workflow</h3>
                    <p>A step-by-step process for converting large batches of MP3 files to accurate SRT files.</p>

                    <div class="step-list">
                        <div class="step-item">
                            <span class="step-number">1</span>
                            <strong>Prepare Your Files:</strong> Organize your MP3 files in a folder. Ensure good audio quality for best transcription results.
                        </div>
                        <div class="step-item">
                            <span class="step-number">2</span>
                            <strong>Generate Templates (This Tool):</strong> Upload all MP3s to this tool and generate SRT templates with perfect timing.
                        </div>
                        <div class="step-item">
                            <span class="step-number">3</span>
                            <strong>Choose Transcription Method:</strong>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li><strong>Free (YouTube):</strong> Upload MP3s as unlisted videos, get auto-captions</li>
                                <li><strong>Free (Otter.ai):</strong> 600 minutes monthly, good for regular batches</li>
                                <li><strong>Paid (Professional):</strong> Use Temi, Rev, or similar for highest accuracy</li>
                            </ul>
                        </div>
                        <div class="step-item">
                            <span class="step-number">4</span>
                            <strong>Quality Control:</strong> Compare transcribed SRT files with your templates to ensure timing accuracy.
                        </div>
                        <div class="step-item">
                            <span class="step-number">5</span>
                            <strong>Batch Processing:</strong> For large volumes, split into batches based on service limits (e.g., 10 files at a time).
                        </div>
                    </div>

                    <div style="background: #fff3e0; padding: 20px; border-radius: 10px; margin: 20px 0;">
                        <h4 style="color: #f57c00; margin-bottom: 15px;">üéØ Pro Tips for Batch Conversion:</h4>
                        <ul class="feature-list">
                            <li><strong>File Organization:</strong> Name files systematically (01_intro.mp3, 02_chapter1.mp3)</li>
                            <li><strong>Audio Quality:</strong> Clear speech = better transcription accuracy</li>
                            <li><strong>Batch Sizes:</strong> Process 5-10 files at once to manage workflow</li>
                            <li><strong>Backup Templates:</strong> Keep SRT templates as backup for manual editing</li>
                            <li><strong>Quality Check:</strong> Spot-check random files for accuracy</li>
                            <li><strong>Time Management:</strong> YouTube method: 15 mins processing per file</li>
                        </ul>
                    </div>

                    <div style="text-align: center; margin: 20px 0;">
                        <a href="https://studio.youtube.com" target="_blank" class="btn">
                            üöÄ Start with YouTube Studio
                        </a>
                        <a href="https://otter.ai" target="_blank" class="btn secondary">
                            ü¶¶ Try Otter.ai Free
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let selectedFiles = [];
        let processingIndex = 0;

        const fileInput = document.getElementById('fileInput');
        const uploadZone = document.querySelector('.upload-zone');
        const fileList = document.getElementById('fileList');
        const generateAllBtn = document.getElementById('generateAllBtn');
        const batchProgress = document.getElementById('batchProgress');
        const progressFill = document.getElementById('progressFill');
        const progressText = document.getElementById('progressText');
        const downloadSection = document.getElementById('downloadSection');

        // Tab switching
        function switchTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabName + 'Tab').classList.add('active');
        }

        // File handling
        fileInput.addEventListener('change', handleFileSelect);

        uploadZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadZone.classList.add('dragover');
        });

        uploadZone.addEventListener('dragleave', () => {
            uploadZone.classList.remove('dragover');
        });

        uploadZone.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadZone.classList.remove('dragover');
            
            const files = Array.from(e.dataTransfer.files).filter(file => 
                file.type.startsWith('audio/') || 
                /\.(mp3|wav|m4a|ogg|flac)$/i.test(file.name)
            );
            addFiles(files);
        });

        function handleFileSelect(e) {
            const files = Array.from(e.target.files);
            addFiles(files);
        }

        function addFiles(files) {
            files.forEach(file => {
                if (!selectedFiles.some(f => f.name === file.name && f.size === file.size)) {
                    selectedFiles.push({
                        file: file,
                        duration: null,
                        id: Date.now() + Math.random(),
                        processed: false
                    });
                }
            });
            updateFileList();
            loadAudioDurations();
            generateAllBtn.disabled = selectedFiles.length === 0;
        }

        function updateFileList() {
            fileList.innerHTML = '';
            selectedFiles.forEach((fileObj, index) => {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item';
                const durationText = fileObj.duration ? ` ‚Ä¢ ${Math.round(fileObj.duration)}s` : '';
                const statusText = fileObj.processed ? ' ‚Ä¢ ‚úÖ Template Ready' : ' ‚Ä¢ ‚è≥ Pending';
                
                fileItem.innerHTML = `
                    <div class="file-info">
                        <div class="file-icon">üéµ</div>
                        <div class="file-details">
                            <h4>${fileObj.file.name}</h4>
                            <p>${formatFileSize(fileObj.file.size)}${durationText}${statusText}</p>
                        </div>
                    </div>
                    <div class="file-actions">
                        <button class="small-btn" onclick="generateSingleTemplate(${index})">
                            üì• Template
                        </button>
                        <button class="small-btn" onclick="removeFile(${index})" style="background: #f44336;">
                            ‚ùå Remove
                        </button>
                    </div>
                `;
                fileList.appendChild(fileItem);
            });
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function removeFile(index) {
            selectedFiles.splice(index, 1);
            updateFileList();
            generateAllBtn.disabled = selectedFiles.length === 0;
        }

        function clearAllFiles() {
            selectedFiles = [];
            updateFileList();
            generateAllBtn.disabled = true;
            downloadSection.classList.remove('show');
            batchProgress.style.display = 'none';
        }

        async function getAudioDuration(file) {
            return new Promise((resolve) => {
                const audio = document.createElement('audio');
                const url = URL.createObjectURL(file);
                audio.src = url;
                
                audio.addEventListener('loadedmetadata', () => {
                    URL.revokeObjectURL(url);
                    resolve(audio.duration);
                });
                
                audio.addEventListener('error', () => {
                    URL.revokeObjectURL(url);
                    resolve(120); // Default to 2 minutes if can't load
                });
            });
        }

        async function loadAudioDurations() {
            for (let fileObj of selectedFiles) {
                if (!fileObj.duration) {
                    fileObj.duration = await getAudioDuration(fileObj.file);
                    updateFileList();
                }
            }
        }

        async function generateSingleTemplate(index) {
            const fileObj = selectedFiles[index];
            if (!fileObj) return;

            const srtContent = await createSRTTemplate(fileObj.file, fileObj.duration, index);
            const filename = getOutputFilename(fileObj.file.name, index);
            downloadSRT(srtContent, filename);
            
            fileObj.processed = true;
            updateFileList();
        }

        async function generateAllTemplates() {
            if (selectedFiles.length === 0) return;

            generateAllBtn.disabled = true;
            batchProgress.style.display = 'block';
            processingIndex = 0;

            for (let i = 0; i < selectedFiles.length; i++) {
                const fileObj = selectedFiles[i];
                processingIndex = i;
                
                // Update progress
                const progress = ((i + 1) / selectedFiles.length) * 100;
                progressFill.style.width = progress + '%';
                progressText.textContent = `Processing ${i + 1} of ${selectedFiles.length}: ${fileObj.file.name}`;

                // Generate template
                const srtContent = await createSRTTemplate(fileObj.file, fileObj.duration, i);
                const filename = getOutputFilename(fileObj.file.name, i);
                downloadSRT(srtContent, filename);
                
                fileObj.processed = true;
                
                // Small delay between downloads to prevent browser blocking
                await new Promise(resolve => setTimeout(resolve, 500));
            }

            // Complete
            progressFill.style.width = '100%';
            progressText.textContent = `‚úÖ Complete! Generated ${selectedFiles.length} SRT templates`;
            downloadSection.classList.add('show');
            generateAllBtn.disabled = false;
            
            setTimeout(() => {
                batchProgress.style.display = 'none';
            }, 3000);
            
            updateFileList();
        }

        function getOutputFilename(originalName, index) {
            const baseName = originalName.replace(/\.[^/.]+$/, '');
            const namingPattern = document.getElementById('namingPattern').value;
            
            switch(namingPattern) {
                case 'template':
                    return `${baseName}_template.srt`;
                case 'numbered':
                    return `${(index + 1).toString().padStart(2, '0')}_${baseName}.srt`;
                default:
                    return `${baseName}.srt`;
            }
        }

        async function createSRTTemplate(audioFile, duration, index) {
            if (!duration) {
                duration = await getAudioDuration(audioFile);
            }

            const segmentLength = parseInt(document.getElementById('segmentLength').value);
            const templateStyle = document.getElementById('templateStyle').value;
            const segments = Math.ceil(duration / segmentLength);
            
            let srt = '';
            
            for (let i = 0; i < segments; i++) {
                const startTime = i * segmentLength;
                const endTime = Math.min((i + 1) * segmentLength, duration);
                
                let text;
                switch(templateStyle) {
                    case 'edit':
                        text = `[Edit this text - Segment ${i + 1}]`;
                        break;
                    case 'numbered':
                        text = `[${i + 1}]`;
                        break;
                    case 'timestamp':
                        text = `[${formatSRTTime(startTime)} to ${formatSRTTime(endTime)}]`;
                        break;
                    case 'speaker':
                        text = `[Speaker: Add transcription here]`;
                        break;
                    case 'blank':
                        text = ' ';
                        break;
                    default:
                        text = `[Edit this text - Segment ${i + 1}]`;
                }
                
                srt += `${i + 1}\n`;
                srt += `${formatSRTTime(startTime)} --> ${formatSRTTime(endTime)}\n`;
                srt += `${text}\n\n`;
            }
            
            return srt;
        }

        function formatSRTTime(seconds) {
            const hours = Math.floor(seconds / 3600);
            const minutes = Math.floor((seconds % 3600) / 60);
            const secs = Math.floor(seconds % 60);
            const ms = Math.floor((seconds % 1) * 1000);
            
            return `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')},${ms.toString().padStart(3, '0')}`;
        }

        function downloadSRT(content, filename) {
            try {
                const blob = new Blob([content], { type: 'text/plain;charset=utf-8' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                a.style.display = 'none';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                
                setTimeout(() => {
                    URL.revokeObjectURL(url);
                }, 100);
                
                console.log(`Downloaded: ${filename}`);
            } catch (error) {
                console.error('Download error:', error);
                alert(`Download failed for ${filename}. Please try again.`);
            }
        }

        function downloadTestSRT() {
            const testContent = `1
00:00:00,000 --> 00:00:08,000
This is a test SRT file for batch MP3 to SRT conversion.

2
00:00:08,000 --> 00:00:16,000
Upload your MP3 files to generate perfectly timed templates.

3
00:00:16,000 --> 00:00:24,000
Use real transcription services for actual speech-to-text.

4
00:00:24,000 --> 00:00:32,000
YouTube auto-captions provide free professional transcription.

5
00:00:32,000 --> 00:00:40,000
Otter.ai offers 600 free minutes per month for batch processing.

6
00:00:40,000 --> 00:00:48,000
This workflow handles large batches efficiently and professionally.
`;
            downloadSRT(testContent, 'batch-converter-test.srt');
            alert('‚úÖ Test SRT downloaded!\n\nüéØ This demonstrates the output format.\n\nüìã Next steps:\n1. Upload your MP3 files\n2. Generate SRT templates\n3. Use real transcription services\n4. Get actual speech-to-text SRT files!');
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('üéØ Batch MP3 to SRT Converter Ready!');
            console.log('Features:');
            console.log('- Batch SRT template generation');
            console.log('- Real transcription service integration');
            console.log('- Complete workflow guidance');
            console.log('- Perfect for large batch processing');
            
            // Add some helpful tips
            setTimeout(() => {
                if (selectedFiles.length === 0) {
                    console.log('üí° Tip: Upload multiple MP3 files at once for batch processing!');
                }
            }, 2000);
        });

        // Add global error handling
        window.addEventListener('error', (e) => {
            console.error('Error:', e.error);
            if (batchProgress.style.display === 'block') {
                progressText.textContent = 'Error occurred. Please try again.';
                generateAllBtn.disabled = false;
            }
        });

        // Add beforeunload warning if processing
        window.addEventListener('beforeunload', (e) => {
            if (batchProgress.style.display === 'block') {
                e.preventDefault();
                e.returnValue = '';
                return 'Batch processing in progress. Are you sure you want to leave?';
            }
        });
    </script>
</body>
</html>